% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/safe2x2Test.R
\name{simulateFisherSpreadSampleSizeOptionalStopping}
\alias{simulateFisherSpreadSampleSizeOptionalStopping}
\title{Function that can be used to illustrate that H0 is falsely rejected too often when using
Fisher's exact test in the optional stopping setting.}
\usage{
simulateFisherSpreadSampleSizeOptionalStopping(
  deltaDesign,
  alpha,
  power,
  M,
  parametersDataGeneratingDistribution,
  nDesign = NA,
  highN = 200,
  makePlot = FALSE
)
}
\arguments{
\item{deltaDesign}{minimal difference in mean proportions between group a and b
we want to be able to detect with a certain power.}

\item{alpha}{significance level used for testing.}

\item{power}{minimal power we want to achieve}

\item{M}{number of simulations to carry out.}

\item{parametersDataGeneratingDistribution}{Vector with actual values of the means in groups a and
b in the data generating distribution to simulate for. Values between 0 and 1.}

\item{nDesign}{if n has been designed/ determined previously, it can be passed
here and simulations to find the design sample size are omitted. This saves
time. Default \code{NA}.}

\item{highN}{maximal nDesign: if no nDesign is found to achieve the desired power
for the \code{deltaDesign} below \code{highN}, simulations are stopped.}

\item{makePlot}{logical indicating whether a histogram of stopping times should be
plotted.}
}
\value{
see \code{\link{simulateSpreadSampleSizeTwoProportions}}
}
\description{
Simulates what would happen if we would use Fisher's exact test in the optional
stopping setting. First, determines the sample size we should use according to design with
simulations. Can be omitted if planned sample size is already known and passed through
Then, starts sampling from the passed distribution up to this sample size in each simulation, and stops
if a significant Fisher's exact test is recorded during sampling.
}
\examples{
\dontrun{
simulationResult <- simulateFisherSpreadSampleSizeOptionalStopping(deltaDesign = 0.5,
alpha = 0.05, power = 0.8, M = 100,
parametersDataGeneratingDistribution = c(0.4, 0.4))
#what was the power?
mean(simulationResult$rejected)
#what sample size can be expected to be collected with optional stopping?
mean(simulationResult$actually_collected)

#nDesign already known
simulationResult <- simulateFisherSpreadSampleSizeOptionalStopping(deltaDesign = 0.5,
alpha = 0.05, power = 0.8, M = 1000, nDesign = 40,
parametersDataGeneratingDistribution = c(0.4, 0.4))
}

}
